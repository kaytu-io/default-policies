ID: aws_efs_file_system_enforces_ssl
Title: EFS file systems should enforce SSL
Description: To help protect data in transit, ensure that your EFS file systems require
  requests to use Secure Socket Layer (SSL).
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    with ssl_ok as (\n      select\n        distinct name,\n        arn,\n
    \       'ok' as status\n      from\n        aws_efs_file_system,\n        jsonb_array_elements(policy_std
    -> 'Statement') as s,\n        jsonb_array_elements_text(s -> 'Principal' -> 'AWS')
    as p,\n        jsonb_array_elements_text(s -> 'Action') as a,\n        jsonb_array_elements_text(\n
    \         s -> 'Condition' -> 'Bool' -> 'aws:securetransport'\n        ) as ssl\n
    \     where\n        p = '*'\n        and s ->> 'Effect' = 'Deny'\n        and
    ssl :: bool = false\n    )\n    select\n      f.arn as resource,\n      case\n
    \       when ok.status = 'ok' then 'ok'\n        else 'alarm'\n      end as status,\n
    \     case\n        when ok.status = 'ok' then f.title || ' policy enforces HTTPS.'\n
    \       else f.title || ' policy does not enforce HTTPS.'\n      end as reason\n
    \     \n      \n    from\n      aws_efs_file_system as f\n      left join ssl_ok
    as ok on ok.name = f.name;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
