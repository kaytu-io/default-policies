ID: azure_hdinsight_cluster_encryption_in_transit_enabled
Title: Azure HDInsight clusters should use encryption in transit to encrypt communication between Azure HDInsight cluster nodes
Description: Data can be tampered with during transmission between Azure HDInsight cluster nodes. Enabling encryption in transit addresses problems of misuse and tampering during this transmission.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          a.id as resource,
          case
            when provisioning_state <> 'Succeeded' then 'skip'
            when encryption_in_transit_properties -> 'isEncryptionInTransitEnabled' = 'true' then 'ok'
            else 'alarm'
          end as status,
          case
            when provisioning_state <> 'Succeeded' then a.name || ' is in ' || provisioning_state || ' state.'
            when encryption_in_transit_properties -> 'isEncryptionInTransitEnabled' = 'true' then a.name || ' encryption in transit enabled.'
            else a.name || ' encryption in transit disabled.'
          end as reason
          
          
          
        from
          azure_hdinsight_cluster as a,
          azure_subscription as sub
        where
          sub.subscription_id = a.subscription_id;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- azure
Tags: {}
Severity: low
