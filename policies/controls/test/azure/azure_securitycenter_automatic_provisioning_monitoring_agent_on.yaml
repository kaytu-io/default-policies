ID: azure_securitycenter_automatic_provisioning_monitoring_agent_on
Title: Auto provisioning of the Log Analytics agent should be enabled on your subscription
Description: To monitor for security vulnerabilities and threats, Azure Security Center collects data from your Azure virtual machines. Data is collected by the Log Analytics agent, formerly known as the Microsoft Monitoring Agent (MMA), which reads various security-related configurations and event logs from the machine and copies the data to your Log Analytics workspace for analysis. We recommend enabling auto provisioning to automatically deploy the agent to all supported Azure VMs and any new ones that are created.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          sc_prov.id as resource,
          case
            when auto_provision = 'On' then 'ok'
            else 'alarm'
          end as status,
          case
            when auto_provision = 'On' then 'Automatic provisioning of monitoring agent is on.'
            else 'Automatic provisioning of monitoring agent is off.'
          end as reason
          
          
        from
          azure_security_center_auto_provisioning sc_prov
          right join azure_subscription sub on sc_prov.subscription_id = sub.subscription_id;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- azure
Tags: {}
Severity: low
