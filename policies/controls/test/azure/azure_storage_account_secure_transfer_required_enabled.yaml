ID: azure_storage_account_secure_transfer_required_enabled
Title: Secure transfer to storage accounts should be enabled
Description: Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          sa.id as resource,
          case
            when not enable_https_traffic_only then 'alarm'
            else 'ok'
          end as status,
          case
            when not enable_https_traffic_only then sa.name || ' encryption in transit not enabled.'
            else sa.name || ' encryption in transit enabled.'
          end as reason
          
          
          
        from
          azure_storage_account sa,
          azure_subscription sub
        where
          sub.subscription_id = sa.subscription_id;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- azure
Tags: {}
Severity: low
