ID: azure_securitycenter_azure_defender_on_for_k8s
Title: Azure Defender for Kubernetes should be enabled
Description: Azure Defender for Kubernetes provides real-time threat protection for containerized environments and generates alerts for suspicious activities.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          sub_pricing.id as resource,
          case
            when pricing_tier = 'Standard' then 'ok'
            else 'alarm'
          end as status,
          case
            when pricing_tier = 'Standard' then 'Azure Defender on for Kubernetes.'
            else 'Azure Defender off for Kubernetes.'
          end as reason
          
          
        from
          azure_security_center_subscription_pricing sub_pricing
          right join azure_subscription sub on sub_pricing.subscription_id = sub.subscription_id
        where
          name = 'KubernetesService';
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- azure
Tags: {}
Severity: low
