ID: azure_securitycenter_azure_defender_on_for_sqldb
Title: Azure Defender for Azure SQL Database servers should be enabled
Description: Azure Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, and discovering and classifying sensitive data.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          sub_pricing.id as resource,
          case
            when pricing_tier = 'Standard' then 'ok'
            else 'alarm'
          end as status,
          case
            when pricing_tier = 'Standard' then 'Azure Defender on for SQL database servers.'
            else 'Azure Defender off for SQL database servers.'
          end as reason
          
          
        from
          azure_security_center_subscription_pricing sub_pricing
          right join azure_subscription sub on sub_pricing.subscription_id = sub.subscription_id
        where
          name = 'SqlServers';
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- azure
Tags: {}
Severity: low
