ID: azure_keyvault_key_expiration_set
Title: Key Vault keys should have an expiration date
Description: Cryptographic keys should have a defined expiration date and not be permanent. Keys that are valid forever provide a potential attacker with more time to compromise the key. It is a recommended security practice to set expiration dates on cryptographic keys.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          kvk.id as resource,
          case
            when enabled and expires_at is null then 'alarm'
            else 'ok'
          end as status,
          vault_name || ' key ' || name ||
          case
            when enabled and expires_at is null then ' expiration date not set.'
            when not enabled then ' disabled.'
            else ' expiration date set to ' || to_char(expires_at, 'DD-Mon-YYYY') || '.'
          end as reason
          
          
          
        from
          azure_key_vault_key kvk,
          azure_subscription sub
        where
          sub.subscription_id = kvk.subscription_id;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- azure
Tags: {}
Severity: low
