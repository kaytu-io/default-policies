ID: azure_kubernetes_cluster_upgraded_with_non_vulnerable_version
Title: Kubernetes Services should be upgraded to a non-vulnerable Kubernetes version
Description: Upgrade your Kubernetes service cluster to a later Kubernetes version to protect against known vulnerabilities in your current Kubernetes version. Vulnerability CVE-2019-9946 has been patched in Kubernetes versions 1.11.9+, 1.12.7+, 1.13.5+, and 1.14.0+.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          a.id as resource,
          case
            when
              a.kubernetes_version ~ '1\.13\.[0-4]'
              or a.kubernetes_version ~ '1\.12\.[0-6]'
              or a.kubernetes_version ~ '1\.11\.[0-8]'
              or a.kubernetes_version ~ '1.([0-9]|10).[0-9]{1,2}' then 'alarm'
            else 'ok'
          end as status,
          case
            when
              a.kubernetes_version ~ '1\.13\.[0-4]'
              or a.kubernetes_version ~ '1\.12\.[0-6]'
              or a.kubernetes_version ~ '1\.11\.[0-8]'
              or a.kubernetes_version ~ '1.([0-9]|10).[0-9]{1,2}' then a.name || ' not upgraded to a non-vulnerable Kubernetes version.'
            else a.name || ' upgraded to a non-vulnerable Kubernetes version.'
          end as reason
          
          
          
        from
          azure_kubernetes_cluster as a,
          azure_subscription as sub
        where
          sub.subscription_id = a.subscription_id;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- azure
Tags: {}
Severity: low
