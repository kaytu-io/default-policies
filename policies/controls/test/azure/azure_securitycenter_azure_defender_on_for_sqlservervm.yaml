ID: azure_securitycenter_azure_defender_on_for_sqlservervm
Title: Azure Defender for SQL should be enabled for unprotected SQL Managed Instances
Description: Audit each SQL Managed Instance without advanced data security.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          sub_pricing.id as resource,
          case
            when pricing_tier = 'Standard' then 'ok'
            else 'alarm'
          end as status,
          case
            when pricing_tier = 'Standard' then 'Azure Defender on for SQL servers on machines.'
            else 'Azure Defender off for SQL servers on machines.'
          end as reason
          
          
        from
          azure_security_center_subscription_pricing sub_pricing
          right join azure_subscription sub on sub_pricing.subscription_id = sub.subscription_id
        where
          name = 'SqlServerVirtualMachines';
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- azure
Tags: {}
Severity: low
