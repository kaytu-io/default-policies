ID: azure_healthcare_fhir_uses_private_link
Title: Azure API for FHIR should use private link
Description: Azure API for FHIR should have at least one approved private endpoint connection. Clients in a virtual network can securely access resources that have private endpoint connections through private links.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          a.id as resource,
          case
            when private_endpoint_connections is null then 'info'
            when private_endpoint_connections @> '[{"privateLinkServiceConnectionState": "Approved"}]'::jsonb then 'ok'
            else 'alarm'
          end as status,
          case
            when private_endpoint_connections is null then a.name || ' no private link exists.'
            when private_endpoint_connections @> '[{"privateLinkServiceConnectionState": "Approved"}]'::jsonb then a.name || ' using private link.'
            else a.name || ' not using private link.'
          end as reason
          
          
          
        from
          azure_healthcare_service a,
          azure_subscription sub;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- azure
Tags: {}
Severity: low
