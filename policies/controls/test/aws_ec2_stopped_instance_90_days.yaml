ID: aws_ec2_stopped_instance_90_days
Title: Ensure instances stopped for over 90 days are removed
Description: Enable this rule to help with the baseline configuration of Amazon Elastic
  Compute Cloud (Amazon EC2) instances by checking whether Amazon EC2 instances have
  been stopped for more than the allowed number of days, according to your organization's
  standards.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn as resource,\n      case\n        when instance_state
    not in ('stopped', 'stopping') then 'skip'\n        when state_transition_time
    <= (current_date - interval '90' day) then 'alarm'\n        else 'ok'\n      end
    as status,\n      case\n        when instance_state not in ('stopped', 'stopping')
    then title || ' is in ' || instance_state || ' state.'\n        else title ||
    ' stopped since ' || to_char(state_transition_time , 'DD-Mon-YYYY') || ' (' ||
    extract(day from current_timestamp - state_transition_time) || ' days).'\n      end
    as reason\n      \n      \n    from\n      aws_ec2_instance;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
