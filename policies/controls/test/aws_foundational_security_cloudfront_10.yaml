ID: aws_foundational_security_cloudfront_10
Title: 10 CloudFront distributions should not use deprecated SSL protocols between
  edge locations and custom origins
Description: This control checks if Amazon CloudFront distributions are using deprecated
  SSL protocols for HTTPS communication between CloudFront edge locations and your
  custom origins. This control fails if a CloudFront distribution has a CustomOriginConfig
  where OriginSslProtocols includes SSLv3.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    with origin_ssl_protocols as (\n      select\n        distinct
    arn,\n        o -> 'CustomOriginConfig' ->> 'OriginProtocolPolicy' as origin_protocol_policy\n
    \     from\n        aws_cloudfront_distribution,\n        jsonb_array_elements(origins)
    as o\n      where\n        o -> 'CustomOriginConfig' -> 'OriginSslProtocols' ->
    'Items' @> '[\"SSLv3\"]'\n    )\n    select\n      b.arn as resource,\n      case\n
    \       when o.arn is null then 'ok'\n        else 'alarm'\n      end as status,\n
    \     case\n        when o.arn is null then title || ' does not have deprecated
    SSL protocols.'\n        else title || ' has deprecated SSL protocols.'\n      end
    as reason\n      \n      \n    from\n      aws_cloudfront_distribution as b\n
    \     left join origin_ssl_protocols as o on b.arn = o.arn;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: medium
