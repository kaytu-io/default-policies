ID: aws_foundational_security_dynamodb_1
Title: 1 DynamoDB tables should automatically scale capacity with demand
Description: This control checks whether an Amazon DynamoDB table can scale its read
  and write capacity as needed. This control passes if the table uses either on-demand
  capacity mode or provisioned mode with auto scaling configured. Scaling capacity
  with demand avoids throttling exceptions, which helps to maintain availability of
  your applications.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    with table_with_autocaling as (\n      select\n        t.resource_id
    as resource_id,\n        count(t.resource_id) as count\n      from\n        aws_appautoscaling_target
    as t where service_namespace = 'dynamodb'\n        group by t.resource_id\n    )\n
    \   select\n      d.arn as resource,\n      case\n        when d.billing_mode
    = 'PAY_PER_REQUEST' then 'ok'\n        when t.resource_id is null then 'alarm'\n
    \       when t.count < 2 then 'alarm'\n        else 'ok'\n      end as status,\n
    \     case\n        when d.billing_mode = 'PAY_PER_REQUEST' then d.title || '
    on-demand mode enabled.'\n        when t.resource_id is null then d.title || '
    autoscaling not enabled.'\n        when t.count < 2 then d.title || ' auto scaling
    not enabled for both read and write capacity.'\n        else d.title || ' autoscaling
    enabled for both read and write capacity.'\n      end as reason\n      \n      \n
    \   from\n      aws_dynamodb_table as d\n      left join table_with_autocaling
    as t on concat('table/', d.name) = t.resource_id;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: medium
