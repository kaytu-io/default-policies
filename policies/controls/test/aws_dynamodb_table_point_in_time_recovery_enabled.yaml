ID: aws_dynamodb_table_point_in_time_recovery_enabled
Title: DynamoDB table point-in-time recovery should be enabled
Description: Enable this rule to check that information has been backed up. It also maintains the backups by ensuring that point-in-time recovery is enabled in AWS DynamoDB.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          arn as resource,
          case
            when lower( point_in_time_recovery_description ->> 'PointInTimeRecoveryStatus' ) = 'disabled' then 'alarm'
            else 'ok'
          end as status,
          case
            when lower( point_in_time_recovery_description ->> 'PointInTimeRecoveryStatus' ) = 'disabled' then title || ' point-in-time recovery not enabled.'
            else title || ' point-in-time recovery enabled.'
          end as reason
          
          
        from
          aws_dynamodb_table;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
