ID: aws_vpc_configured_to_use_vpc_endpoints
Title: VPC should be configured to use VPC endpoints
Description: Checks if Service Endpoint for the service provided in rule parameter
  is created for each AWS Virtual Private Cloud (AWS VPC). The rule is non-compliant
  if an AWS VPC doesn't have an AWS VPC endpoint created for the service.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn as resource,\n      case\n        when vpc_id
    not in (\n          select\n            vpc_id\n          from\n            aws_vpc_endpoint\n
    \         where\n            service_name like 'com.amazonaws.' || region || '.ec2'\n
    \       ) then 'alarm'\n        else 'ok'\n      end as status,\n      case\n
    \       when vpc_id not in (\n          select\n            vpc_id\n          from\n
    \           aws_vpc_endpoint\n          where\n            service_name like 'com.amazonaws.'
    || region || '.ec2'\n        ) then title || ' not configured to use VPC endpoints.'\n
    \       else title || ' configured to use VPC endpoints.'\n      end as reason\n
    \     \n      \n    from\n      aws_vpc;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
