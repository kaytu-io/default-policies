ID: aws_codebuild_project_source_repo_oauth_configured
Title: CodeBuild GitHub or Bitbucket source repository URLs should use OAuth
Description: Ensure the GitHub or Bitbucket source repository URL does not contain
  personal access tokens, user name and password within AWS Codebuild project environments.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      p.arn as resource,\n      case\n        when
    p.source ->> 'Type' not in ('GITHUB', 'BITBUCKET') then 'skip'\n        when c.auth_type
    = 'OAUTH' then 'ok'\n        else 'alarm'\n      end as status,\n      case\n
    \       when p.source ->> 'Type' = 'NO_SOURCE' then p.title || ' doesn''t have
    input source code.'\n        when p.source ->> 'Type' not in ('GITHUB', 'BITBUCKET')
    then p.title || ' source code isn''t in GitHub/Bitbucket repository.'\n        when
    c.auth_type = 'OAUTH' then p.title || ' using OAuth to connect source repository.'\n
    \       else p.title || ' not using OAuth to connect source repository.'\n      end
    as reason\n      \n      \n    from\n      aws_codebuild_project as p\n      left
    join aws_codebuild_source_credential as c on (p.region = c.region and p.source
    ->> 'Type' = c.server_type);\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
