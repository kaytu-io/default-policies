ID: aws_foundational_security_redshift_2
Title: 2 Connections to Amazon Redshift clusters should be encrypted in transit
Description: This control checks whether connections to Amazon Redshift clusters are
  required to use encryption in transit. The check fails if the Amazon Redshift cluster
  parameter require_SSL is not set to 1. TLS can be used to help prevent potential
  attackers from using person-in-the-middle or similar attacks to eavesdrop on or
  manipulate network traffic. Only encrypted connections over TLS should be allowed.
  Encrypting data in transit can affect performance. You should test your application
  with this feature to understand the performance profile and the impact of TLS.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    with pg_with_ssl as (\n    select\n      name as pg_name,\n
    \     p ->> 'ParameterName' as parameter_name,\n      p ->> 'ParameterValue' as
    parameter_value\n    from\n      aws_redshift_parameter_group,\n      jsonb_array_elements(parameters)
    as p\n    where\n      p ->> 'ParameterName' = 'require_ssl'\n      and p ->>
    'ParameterValue' = 'true'\n    )\n    select\n      arn as resource,\n      case\n
    \       when cpg ->> 'ParameterGroupName' in (select pg_name from pg_with_ssl
    ) then 'ok'\n        else 'alarm'\n      end as status,\n      case\n        when
    cpg ->> 'ParameterGroupName' in (select pg_name from pg_with_ssl ) then title
    || ' encryption in transit enabled.'\n        else title || ' encryption in transit
    disabled.'\n      end as reason\n      \n      \n    from\n      aws_redshift_cluster,\n
    \     jsonb_array_elements(cluster_parameter_groups) as cpg;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: medium
