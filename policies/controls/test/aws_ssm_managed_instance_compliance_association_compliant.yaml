ID: aws_ssm_managed_instance_compliance_association_compliant
Title: SSM managed instance associations should be compliant
Description: Use AWS Systems Manager Associations to help with inventory of software platforms and applications within an organization.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          id as resource,
          case
            when c.status = 'COMPLIANT' then 'ok'
            else 'alarm'
          end as status,
          case
            when c.status = 'COMPLIANT' then c.resource_id || ' association ' || c.title || ' is compliant.'
            else c.resource_id || ' association ' || c.title || ' is non-compliant.'
          end as reason
    
          
        from
          aws_ssm_managed_instance as i,
          aws_ssm_managed_instance_compliance as c
        where
          c.resource_id = i.instance_id
          and c.compliance_type = 'Association';
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
