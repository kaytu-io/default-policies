ID: aws_ec2_instance_iam_profile_attached
Title: EC2 instances should have IAM profile attached
Description: Ensure that an AWS Elastic Compute Cloud (AWS EC2) instance has an Identity
  and Access Management (IAM) profile attached to it. This rule is non-compliant if
  no IAM profile is attached to the AWS EC2 instance.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn as resource,\n      case\n        when iam_instance_profile_id
    is not null then 'ok'\n        else 'alarm'\n      end as status,\n      case\n
    \       when iam_instance_profile_id is not null then title || ' IAM profile attached.'\n
    \       else title || ' IAM profile not attached.'\n      end as reason\n      \n
    \     \n    from\n      aws_ec2_instance;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
