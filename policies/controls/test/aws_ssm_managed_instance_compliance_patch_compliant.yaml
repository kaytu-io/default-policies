ID: aws_ssm_managed_instance_compliance_patch_compliant
Title: SSM managed instance patching should be compliant
Description: Enable this rule to help with identification and documentation of AWS Elastic Compute Cloud (AWS EC2) vulnerabilities.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          id as resource,
          case
            when c.status = '' then 'skip'
            when c.status = 'COMPLIANT' then 'ok'
            else 'alarm'
          end as status,
          case
            when c.status = '' then 'Patch is not applicable for instance ' || i.title || '.'
            when c.status = 'COMPLIANT' then c.resource_id || ' patch ' || c.title || ' is compliant.'
            else c.resource_id || ' patch ' || c.title || ' is non-compliant.'
          end as reason
          
        from
          aws_ssm_managed_instance as i,
          aws_ssm_managed_instance_compliance as c
        where
          c.resource_id = i.instance_id
          and c.compliance_type = 'Patch';
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Connector:
- aws
Tags: {}
Severity: ""
