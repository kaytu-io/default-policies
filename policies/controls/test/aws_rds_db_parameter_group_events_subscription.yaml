ID: aws_rds_db_parameter_group_events_subscription
Title: An RDS event notifications subscription should be configured for critical database
  parameter group events
Description: This control checks whether an AWS RDS event subscription exists with
  notifications enabled for the following source type, event category key-value pairs.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn as resource,\n      case\n        when source_type
    <> 'db-parameter-group' then 'skip'\n        when source_type = 'db-parameter-group'
    and enabled and event_categories_list @> '[\"maintenance\", \"failure\"]' then
    'ok'\n        else 'alarm'\n      end as status,\n      case\n        when source_type
    <> 'db-parameter-group' then cust_subscription_id || ' event subscription of '
    || source_type || ' type.'\n        when source_type = 'db-parameter-group' and
    enabled and event_categories_list @> '[\"configuration change\"]' then cust_subscription_id
    || ' event subscription enabled for critical database parameter group events.'\n
    \       else cust_subscription_id || ' event subscription missing critical database
    parameter group events.'\n      end as reason\n      \n    from\n      aws_rds_db_event_subscription;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
