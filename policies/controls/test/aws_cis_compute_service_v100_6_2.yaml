ID: aws_cis_compute_service_v100_6_2
Title: 6.2 Ensure Persistent logs is setup and configured to S3
Description: Elastic Beanstalk can be configured to automatically stream logs to the
  CloudWatch service.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    with beanstalk_environment_logs_enabled as (\n      select\n
    \       distinct e.arn\n      from\n        aws_elastic_beanstalk_environment
    as e,\n        jsonb_array_elements(e.configuration_settings) as c,\n        jsonb_array_elements(c
    -> 'OptionSettings') as s\n      where\n        s ->> 'OptionName' = 'StreamLogs'\n
    \       and s ->> 'Value' = 'true'\n      group by\n        arn\n    )\n    select\n
    \     e.arn as resource,\n      case\n        when l.arn is not null then 'ok'\n
    \       else 'alarm'\n      end as status,\n      case\n        when l.arn is
    not null then title || ' send logs to AWS CloudWatch.'\n        else title ||
    ' does not send logs to AWS CloudWatch.'\n      end as reason\n      \n      \n
    \   from\n      aws_elastic_beanstalk_environment as e\n      left join beanstalk_environment_logs_enabled
    as l on e.arn = l.arn;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
