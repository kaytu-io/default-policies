ID: aws_codebuild_project_artifact_encryption_enabled
Title: CodeBuild project artifact encryption should be enabled
Description: This control checks if a CodeBuild project has encryption enabled for
  all of its artifacts. The rule is non-compliant if 'encryptionDisabled' is set to
  'true' for any primary or secondary (if present) artifact configurations.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    with secondary_artifact as (\n      select\n        distinct
    arn\n      from\n        aws_codebuild_project,\n        jsonb_array_elements(secondary_artifacts)
    as a\n      where\n        a -> 'EncryptionDisabled' = 'true'\n    )\n    select\n
    \     a.arn as resource,\n      case\n        when p.artifacts ->> 'EncryptionDisabled'
    = 'false'\n        and (p.secondary_artifacts is null or a.arn is null) then 'ok'\n
    \       else 'alarm'\n      end as status,\n      case\n        when p.artifacts
    ->> 'EncryptionDisabled' = 'false'\n        and (p.secondary_artifacts is null
    or a.arn is null) then p.title || ' all artifacts encryption enabled.'\n        else
    p.title || ' all artifacts encryption not enabled.'\n      end as reason\n      \n
    \     \n    from\n      aws_codebuild_project as p\n      left join secondary_artifact
    as a on a.arn = p.arn;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
