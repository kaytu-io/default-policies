ID: aws_foundational_security_rds_5
Title: 5 RDS DB instances should be configured with multiple Availability Zones
Description: This control checks whether high availability is enabled for your RDS
  DB instances. RDS DB instances should be configured for multiple Availability Zones
  (AZs). This ensures the availability of the data stored. Multi-AZ deployments allow
  for automated failover if there is an issue with Availability Zone availability
  and during regular RDS maintenance.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn as resource,\n      case\n        when engine
    ilike any (array ['%aurora-mysql%', '%aurora-postgres%']) then 'skip'\n        when
    multi_az then 'ok'\n        else 'alarm'\n      end as status,\n      case\n        when
    engine ilike any (array ['%aurora-mysql%', '%aurora-postgres%']) then title ||
    ' cluster instance.'\n        when multi_az then title || ' Multi-AZ enabled.'\n
    \       else title || ' Multi-AZ disabled.'\n      end as reason\n      \n      \n
    \   from\n      aws_rds_db_instance;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: medium
