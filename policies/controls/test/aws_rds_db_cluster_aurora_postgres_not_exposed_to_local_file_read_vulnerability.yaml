ID: aws_rds_db_cluster_aurora_postgres_not_exposed_to_local_file_read_vulnerability
Title: RDS Aurora PostgreSQL clusters should not be exposed to local file read vulnerability
Description: This control checks whether AWS Aurora PostgreSQL clusters are exposed to local file read vulnerability by ensuring that AWS RDS PostgreSQL instances use a non-vulnerable version of the log_fdw.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          arn as resource,
          case
            when not engine ilike '%aurora-postgres%' then 'skip'
            when engine ilike '%aurora-postgres%' and engine_version like any (array ['10.11', '10.12', '10.13', '11.6', '11.7', '11.8']) then 'alarm'
            else 'ok'
          end as status,
          case
            when not engine ilike '%aurora-postgres%' then title || ' not Aurora PostgreSQL edition.'
            when engine ilike '%aurora-postgres%' and engine_version like any (array ['10.11', '10.12', '10.13', '11.6', '11.7', '11.8']) then title || ' exposed to local file read vulnerability.'
            else title || ' not exposed to local file read vulnerability.'
          end as reason
          
          
        from
          aws_rds_db_instance;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
