ID: aws_foundational_security_es_2
Title: 2 Elasticsearch domains should not be publicly accessible
Description: This control checks whether Amazon Elasticsearch Service domains are
  in a VPC. It does not evaluate the VPC subnet routing configuration to determine
  public access. You should ensure that Amazon ES domains are not attached to public
  subnets.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn as resource,\n      case\n        when vpc_options
    ->> 'VPCId' is null then 'alarm'\n        else 'ok'\n      end status,\n      case\n
    \       when vpc_options ->> 'VPCId' is null then title || ' not in VPC.'\n        else
    title || ' in VPC ' || (vpc_options ->> 'VPCId') || '.'\n      end reason\n      \n
    \     \n    from\n      aws_elasticsearch_domain;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: critical
