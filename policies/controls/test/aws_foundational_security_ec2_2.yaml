ID: aws_foundational_security_ec2_2
Title: 2 VPC default security groups should not allow inbound or outbound traffic
Description: This control checks that the default security group of a VPC does not
  allow inbound or outbound traffic. The rules for the default security group allow
  all outbound and inbound traffic from network interfaces (and their associated instances)
  that are assigned to the same security group.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn resource,\n      case\n        when jsonb_array_length(ip_permissions)
    = 0 and jsonb_array_length(ip_permissions_egress) = 0 then 'ok'\n        else
    'alarm'\n      end status,\n      case\n        when jsonb_array_length(ip_permissions)
    > 0 and jsonb_array_length(ip_permissions_egress) > 0\n          then 'Default
    security group ' || group_id || ' has inbound and outbound rules.'\n        when
    jsonb_array_length(ip_permissions) > 0 and jsonb_array_length(ip_permissions_egress)
    = 0\n          then 'Default security group ' || group_id || ' has inbound rules.'\n
    \       when jsonb_array_length(ip_permissions) = 0 and jsonb_array_length(ip_permissions_egress)
    > 0\n          then 'Default security group ' || group_id || ' has outbound rules.'\n
    \       else 'Default security group ' || group_id || ' has no inbound or outbound
    rules.'\n      end reason\n      \n      \n    from\n      aws_vpc_security_group\n
    \   where\n      group_name = 'default';\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: high
