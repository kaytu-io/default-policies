ID: aws_redshift_cluster_encryption_logging_enabled
Title: Redshift cluster audit logging and encryption should be enabled
Description: To protect data at rest, ensure that encryption is enabled for your AWS Redshift clusters. You must also ensure that required configurations are deployed on AWS Redshift clusters. The audit logging should be enabled to provide information about connections and user activities in the database.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          arn as resource,
          case
            when not encrypted then 'alarm'
            when not (logging_status ->> 'LoggingEnabled') :: boolean then 'alarm'
            else 'ok'
          end as status,
          case
            when not encrypted then title || ' not encrypted.'
            when not (logging_status ->> 'LoggingEnabled')::boolean then title || ' audit logging not enabled.'
            else title || ' audit logging and encryption enabled.'
          end as reason
          
          
        from
          aws_redshift_cluster;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
