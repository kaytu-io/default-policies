ID: aws_rds_db_snapshot_prohibit_public_access
Title: RDS snapshots should prohibit public access
Description: Manage access to resources in the AWS Cloud by ensuring that AWS Relational
  Database Service (AWS RDS) instances are not public.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    (\n    select\n      arn as resource,\n      case\n        when
    cluster_snapshot -> 'AttributeValues' = '[\"all\"]' then 'alarm'\n        else
    'ok'\n      end status,\n      case\n        when cluster_snapshot -> 'AttributeValues'
    = '[\"all\"]' then title || ' publicly restorable.'\n        else title || ' not
    publicly restorable.'\n      end reason\n      \n      \n    from\n      aws_rds_db_cluster_snapshot,\n
    \     jsonb_array_elements(db_cluster_snapshot_attributes) as cluster_snapshot\n
    \   )\n    union\n    (\n    select\n      arn as resource,\n      case\n        when
    database_snapshot -> 'AttributeValues' = '[\"all\"]' then 'alarm'\n        else
    'ok'\n      end status,\n      case\n        when database_snapshot -> 'AttributeValues'
    = '[\"all\"]' then title || ' publicly restorable.'\n        else title || ' not
    publicly restorable.'\n      end reason\n      \n      \n    from\n      aws_rds_db_snapshot,\n
    \     jsonb_array_elements(db_snapshot_attributes) as database_snapshot\n    );\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
