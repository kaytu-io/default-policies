ID: aws_wafv2_rule_group_logging_enabled
Title: AWS WAF rules should have CloudWatch metrics enabled
Description: This control checks whether an AWS WAF rule or rule group has Amazon
  CloudWatch metrics enabled. The control fails if the rule or rule group doesn't
  have CloudWatch metrics enabled.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn as resource,\n      case\n        when (visibility_config
    ->> 'CloudWatchMetricsEnabled')::bool then 'ok'\n        else 'alarm'\n      end
    as status,\n      case\n        when (visibility_config ->> 'CloudWatchMetricsEnabled')::bool
    then title || ' logging enabled.'\n        else title || ' logging disabled.'\n
    \     end as reason\n      \n      \n    from\n      aws_wafv2_rule_group;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
