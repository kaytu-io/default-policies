ID: aws_elasticache_redis_cluster_automatic_backup_retention_15_days
Title: ElastiCache Redis cluster automatic backup should be enabled with retention period of 15 days or greater
Description: When automatic backups are enabled, AWS ElastiCache creates a backup of the cluster on a daily basis. The backup can be retained for a number of days as specified by your organization. Automatic backups can help guard against data loss.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          arn as resource,
          case
            when snapshot_retention_limit < 15 then 'alarm'
            else 'ok'
          end as status,
          case
            when snapshot_retention_limit = 0 then title || ' automatic backups not enabled.'
            when snapshot_retention_limit < 15 then title || ' automatic backup retention period is less than 15 days.'
            else title || ' automatic backup retention period is more than 15 days.'
          end as reason
          
        from
          aws_elasticache_replication_group;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
