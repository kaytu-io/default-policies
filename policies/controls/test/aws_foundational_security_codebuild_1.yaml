ID: aws_foundational_security_codebuild_1
Title: 1 CodeBuild Bitbucket source repository URLs should not contain sensitive credentials
Description: Authentication credentials should never be stored or transmitted in clear
  text or appear in the repository URL. Instead of personal access tokens or user
  name and password, you should use OAuth to grant authorization for accessing GitHub
  or Bitbucket repositories. Using personal access tokens or a user name and password
  could expose your credentials to unintended data exposure and unauthorized access.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      p.arn as resource,\n      case\n        when
    p.source ->> 'Type' not in ('GITHUB', 'BITBUCKET') then 'skip'\n        when c.auth_type
    = 'OAUTH' then 'ok'\n        else 'alarm'\n      end as status,\n      case\n
    \       when p.source ->> 'Type' = 'NO_SOURCE' then p.title || ' doesn''t have
    input source code.'\n        when p.source ->> 'Type' not in ('GITHUB', 'BITBUCKET')
    then p.title || ' source code isn''t in GitHub/Bitbucket repository.'\n        when
    c.auth_type = 'OAUTH' then p.title || ' using OAuth to connect source repository.'\n
    \       else p.title || ' not using OAuth to connect source repository.'\n      end
    as reason\n      \n      \n    from\n      aws_codebuild_project as p\n      left
    join aws_codebuild_source_credential as c on (p.region = c.region and p.source
    ->> 'Type' = c.server_type);\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: critical
