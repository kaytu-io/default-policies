ID: aws_iam_group_user_role_no_inline_policies
Title: IAM groups, users, and roles should not have any inline policies
Description: Ensure an AWS Identity and Access Management (IAM) user, IAM role or IAM group does not have an inline policy to control access to systems and assets.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          arn as resource,
          case
            when inline_policies is null then 'ok'
            else 'alarm'
          end status,
          'User ' || title || ' has ' || coalesce(jsonb_array_length(inline_policies), 0) || ' inline policies.' as reason
          
        from
          aws_iam_user
        union
        select
          arn as resource,
          case
            when inline_policies is null then 'ok'
            else 'alarm'
          end status,
          'Role ' || title || ' has ' || coalesce(jsonb_array_length(inline_policies), 0) || ' inline policies.' as reason
          
        from
          aws_iam_role
        where
          arn not like '%service-role/%'
        union
        select
          arn as resource,
          case
            when inline_policies is null then 'ok'
            else 'alarm'
          end status,
          'Group ' || title || ' has ' || coalesce(jsonb_array_length(inline_policies), 0) || ' inline policies.' as reason
          
        from
          aws_iam_group;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
