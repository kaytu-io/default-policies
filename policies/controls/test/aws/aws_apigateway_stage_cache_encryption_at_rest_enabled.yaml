ID: aws_apigateway_stage_cache_encryption_at_rest_enabled
Title: API Gateway stage cache encryption at rest should be enabled
Description: To help protect data at rest, ensure encryption is enabled for your API Gateway stage's cache.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          'arn:' || partition || ':apigateway:' || region || '::/apis/' || rest_api_id || '/stages/' || name as resource,
          case
            when method_settings -> '*/*' ->> 'CachingEnabled' = 'true'
            and method_settings -> '*/*' ->> 'CacheDataEncrypted' = 'true' then 'ok'
            else 'alarm'
          end as status,
          case
            when method_settings -> '*/*' ->> 'CachingEnabled' = 'true'
            and method_settings -> '*/*' ->> 'CacheDataEncrypted' = 'true'
              then title || ' API cache and encryption enabled.'
            else title || ' API cache and encryption not enabled.'
          end as reason
          
          
        from
          aws_api_gateway_stage;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
