ID: aws_foundational_security_es_1
Title: 1 Elasticsearch domains should have encryption at-rest enabled
Description: This control checks whether Amazon Elasticsearch Service (Amazon ES)
  domains have encryption at rest configuration enabled. The check fails if encryption
  at rest is not enabled.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn as resource,\n      case\n        when encryption_at_rest_options
    ->> 'Enabled' = 'false' then 'alarm'\n        else 'ok'\n      end status,\n      case\n
    \       when encryption_at_rest_options ->> 'Enabled' = 'false' then title ||
    ' encryption at rest not enabled.'\n        else title || ' encryption at rest
    enabled.'\n      end reason\n      \n      \n    from\n      aws_elasticsearch_domain;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: medium
