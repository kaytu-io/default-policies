ID: aws_eks_cluster_control_plane_audit_logging_enabled
Title: EKS clusters should have control plane audit logging enabled
Description: AWS EKS clusters should have control plane audit logging enabled. These
  logs make it easy to secure and run clusters.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    with control_panel_audit_logging as (\n      select\n        distinct
    arn,\n        log -> 'Types' as log_type\n      from\n        aws_eks_cluster,\n
    \       jsonb_array_elements(logging -> 'ClusterLogging') as log\n      where\n
    \       log ->> 'Enabled' = 'true'\n        and (log -> 'Types') @> '[\"api\",
    \"audit\", \"authenticator\", \"controllerManager\", \"scheduler\"]'\n    )\n
    \   select\n      c.arn as resource,\n      case\n        when l.arn is not null
    then 'ok'\n        else 'alarm'\n      end as status,\n      case\n        when
    l.arn is not null then c.title || ' control plane audit logging enabled for all
    log types.'\n        else\n          case when logging -> 'ClusterLogging' @>
    '[{\"Enabled\": true}]' then c.title || ' control plane audit logging not enabled
    for all log types.'\n          else c.title || ' control plane audit logging not
    enabled.'\n          end\n      end as reason\n      \n      \n    from\n      aws_eks_cluster
    as c\n      left join control_panel_audit_logging as l on l.arn = c.arn;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
