ID: aws_iam_account_password_policy_strong_min_reuse_24
Title: IAM password policies for users should have strong configurations
Description: The identities and the credentials are issued, managed, and verified
  based on an organizational IAM password policy.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      'arn:' || a.partition || ':::' || a.account_id
    as resource,\n      case\n        when\n          minimum_password_length >= 14\n
    \         and password_reuse_prevention >= 24\n          and require_lowercase_characters
    = 'true'\n          and require_uppercase_characters = 'true'\n          and require_numbers
    = 'true'\n          and require_symbols = 'true'\n          and max_password_age
    <= 90\n        then 'ok'\n        else 'alarm'\n      end as status,\n      case\n
    \       when minimum_password_length is null then 'No password policy set.'\n
    \       when\n          minimum_password_length >= 14\n          and password_reuse_prevention
    >= 24\n          and require_lowercase_characters = 'true'\n          and require_uppercase_characters
    = 'true'\n          and require_numbers = 'true'\n          and require_symbols
    = 'true'\n          and max_password_age <= 90\n        then 'Strong password
    policies configured.'\n        else 'Password policy ' ||\n          concat_ws(',
    ',\n            case when minimum_password_length < 14 then ('minimum password
    length set to ' || minimum_password_length) end,\n            case when password_reuse_prevention
    < 24 then ('password reuse prevention set to ' || password_reuse_prevention) end,\n
    \           case when not (require_lowercase_characters = 'true') then 'lowercase
    characters not required' end,\n            case when not (require_uppercase_characters
    = 'true') then 'uppercase characters not required' end,\n            case when
    not (require_numbers) then 'numbers not required' end,\n            case when
    not (require_symbols) then 'symbols not required' end,\n            case when
    max_password_age > 90 then ('max password age set to ' || max_password_age) end\n
    \         ) || '.'\n      end as reason\n      \n    from\n      aws_account as
    a\n      left join aws_iam_account_password_policy as pol on a.account_id = pol.account_id;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
