ID: aws_cis_v140_1_16
Title: 1.16 Ensure IAM policies that allow full \"*:*\" administrative privileges
  are not attached
Description: IAM policies are the means by which privileges are granted to users,
  groups, or roles. It is recommended and considered a standard security advice to
  grant least privilege -that is, granting only the permissions required to perform
  a task. Determine what users need to do and then craft policies for them that let
  the users perform only those tasks, instead of allowing full administrative privileges.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    with star_access_policies as (\n      select\n        arn,\n
    \       is_aws_managed,\n        count(*) as num_bad_statements\n      from\n
    \       aws_iam_policy,\n        jsonb_array_elements(policy_std -> 'Statement')
    as s,\n        jsonb_array_elements_text(s -> 'Resource') as resource,\n        jsonb_array_elements_text(s
    -> 'Action') as action\n      where\n        s ->> 'Effect' = 'Allow'\n        and
    resource = '*'\n        and (\n          (action = '*'\n          or action =
    '*:*'\n          )\n        )\n        and is_attached\n      group by\n        arn,\n
    \       is_aws_managed\n    )\n    select\n      p.arn as resource,\n      case\n
    \       when s.arn is not null and s.is_aws_managed then 'info'\n        when
    s.arn is null then 'ok'\n        else 'alarm'\n      end status,\n      case\n
    \       when s.arn is not null and s.is_aws_managed then p.name || ' is an AWS
    managed policy with ' || coalesce(s.num_bad_statements, 0) || ' statements that
    allow action \"*\" on resource \"*\".'\n        else p.name || ' contains ' ||
    coalesce(s.num_bad_statements, 0) || ' statements that allow action \"*\" on resource
    \"*\".'\n      end as reason\n      \n      \n    from\n      aws_iam_policy as
    p\n      left join star_access_policies as s on p.arn = s.arn\n    where\n      p.is_attached;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
