ID: aws_redshift_cluster_kms_enabled
Title: AWS Redshift clusters should be encrypted with KMS
Description: Ensure that AWS Redshift clusters are using a specified AWS Key Management Service (AWS KMS) key for encryption. The rule is compliant if encryption is enabled and the cluster is encrypted with the key provided in the kmsKeyArn parameter. The rule is non-compliant if the cluster is not encrypted or encrypted with another key.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          arn as resource,
          case
            when encrypted and kms_key_id is not null then 'ok'
            else 'alarm'
          end as status,
          case
            when encrypted and kms_key_id is not null then title || ' encrypted with KMS.'
            else title || ' not encrypted with KMS'
          end as reason
          
          
        from
          aws_redshift_cluster;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Connector:
- aws
Tags: {}
Severity: ""
