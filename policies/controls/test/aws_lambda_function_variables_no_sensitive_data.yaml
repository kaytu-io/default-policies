ID: aws_lambda_function_variables_no_sensitive_data
Title: Lambda functions variable should not have any sensitive data
Description: Ensure functions environment variables is not having any sensitive data.
  Leveraging Secrets Manager enables secure provisioning of database credentials to
  Lambda functions while also ensuring the security of databases. This approach eliminates
  the need to hardcode secrets in code or pass them through environmental variables.
  Additionally, Secrets Manager facilitates the secure retrieval of credentials for
  establishing connections to databases and performing queries, enhancing overall
  security measures.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    with function_vaiable_with_sensitive_data as (\n    select\n
    \     distinct arn,\n      name\n    from\n      aws_lambda_function\n      join
    jsonb_each_text(environment_variables) d on true\n    where\n      d.key ilike
    any (array['%pass%', '%secret%', '%token%', '%key%'])\n      or d.key ~ '(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]'\n
    \     or d.value ilike any (array['%pass%', '%secret%', '%token%', '%key%'])\n
    \     or d.value ~ '(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]'\n
    \   )\n    select\n      f.arn as resource,\n      case\n        when b.arn is
    null then 'ok'\n        else 'alarm'\n      end as status,\n      case\n        when
    b.arn is null then f.title || ' has no sensitive data.'\n        else f.title
    || ' has potential sensitive data.'\n      end as reason\n      \n      \n    from\n
    \     aws_lambda_function as f\n      left join function_vaiable_with_sensitive_data
    b on f.arn = b.arn;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
