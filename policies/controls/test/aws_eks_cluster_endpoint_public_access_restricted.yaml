ID: aws_eks_cluster_endpoint_public_access_restricted
Title: EKS clusters endpoint public access should be restricted
Description: EKS clusters endpoint with private access allows communication between
  your nodes and the API server stays within. This control is non-compliant if clusters
  endpoint public access is enabled as cluster API server is accessible from the internet.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "    select\n      arn as resource,\n      case\n        when resources_vpc_config
    ->> 'EndpointPrivateAccess' = 'true' and resources_vpc_config ->> 'EndpointPublicAccess'
    = 'false' then 'ok'\n        when resources_vpc_config ->> 'EndpointPublicAccess'
    = 'true' and resources_vpc_config -> 'PublicAccessCidrs' @> '[\"0.0.0.0/0\"]'
    then 'alarm'\n        else 'ok'\n      end as status,\n      case\n        when
    resources_vpc_config ->> 'EndpointPrivateAccess' = 'true' and resources_vpc_config
    ->> 'EndpointPublicAccess' = 'false' then title || ' endpoint access is private.'\n
    \       when resources_vpc_config ->> 'EndpointPublicAccess' = 'true' and resources_vpc_config
    -> 'PublicAccessCidrs' @> '[\"0.0.0.0/0\"]' then title || ' endpoint access is
    public.'\n        else title || ' endpoint public access is restricted.'\n      end
    as reason\n      \n      \n    from\n      aws_eks_cluster;\n"
  Connector:
  - aws
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
  Global: false
Tags: {}
Severity: ""
