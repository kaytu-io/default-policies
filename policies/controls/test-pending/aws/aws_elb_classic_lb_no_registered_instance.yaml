ID: aws_elb_classic_lb_no_registered_instance
Title: ELB classic load balancers should have at least one registered instance
Description: This control checks whether an ELB classic load balancer has registered instances. The control fails if an ELB classic load balancer has zero instances registered.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          arn as resource,
          case
            when jsonb_array_length(instances) = 0 then 'alarm'
            else 'ok'
          end as status,
          title || ' has ' || jsonb_array_length(instances) || ' instance(s) registered.' as reason
          
          
        from
          aws_ec2_classic_load_balancer;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
