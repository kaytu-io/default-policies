ID: aws_multi_account_centralized_management
Title: "AWS Multi-Account Centralized Management"
Description: "Set up, organize and manage your AWS accounts for optimal security and manageability."
Query:
    Engine: odysseus-v0.0.1
    ListOfTables:
        - aws_account
    Parameters: []
    PrimaryTable: aws_account
    QueryToExecute: "SELECT \n  organization_id as resource,\n  kaytu_account_id,\n  kaytu_resource_id,\n  CASE\n    WHEN count(*) = 1 THEN 'alarm'\n    ELSE 'ok'\n  END AS status,\n  CASE\n    WHEN count(*) = 1 THEN organization_id || ' only has one account' \n    ELSE organization_id || ' has multiple accounts'\n  END AS reason\nFROM \n  aws_account\nGROUP BY\n  organization_id,\n  kaytu_account_id,\n  kaytu_resource_id;\n"
Severity: high
Tags:
    score_service_name:
        - AWS Identity and Access Management (IAM)
    score_tags:
        - Tolerate Failures
Connector:
    - AWS
