ID: aws_lambda_function_use_latest_runtime
Title: "Lambda functions should use latest runtimes"
Description: "This control checks that the Lambda function settings for runtimes match the expected values set for the latest runtimes for each supported language. This control checks for the following runtimes: nodejs14.x, nodejs12.x, nodejs10.x, python3.8, python3.7, python3.6, ruby2.7, ruby2.5,java11, java8, go1.x, dotnetcore3.1, dotnetcore2.1."
Severity: medium
Tags:
    aws_foundational_security:
        - "true"
    category:
        - Compliance
    foundational_security_category:
        - secure_development
    foundational_security_item_id:
        - lambda_2
    plugin:
        - aws
    service:
        - AWS/Lambda
Query:
    Engine: odysseus-v0.0.1
    ListOfTables:
        - aws_lambda_function
    Parameters: []
    PrimaryTable: aws_lambda_function
    QueryToExecute: "select\n  arn as resource,\n  kaytu_account_id as kaytu_account_id,\n  kaytu_resource_id as kaytu_resource_id,\n  case\n    when package_type <> 'Zip' then 'skip'\n    when runtime in ('nodejs16.x', 'nodejs14.x', 'nodejs12.x', 'nodejs10.x', 'python3.9', 'python3.8', 'python3.7', 'python3.6', 'ruby2.5', 'ruby2.7', 'java11', 'java8', 'java8.al2', 'go1.x', 'dotnetcore2.1', 'dotnetcore3.1', 'dotnet6') then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when package_type <> 'Zip' then title || ' package type is ' || package_type || '.'\n    when runtime in ('nodejs16.x', 'nodejs14.x', 'nodejs12.x', 'nodejs10.x', 'python3.9', 'python3.8', 'python3.7', 'python3.6', 'ruby2.5', 'ruby2.7', 'java11', 'java8', 'java8.al2', 'go1.x', 'dotnetcore2.1', 'dotnetcore3.1', 'dotnet6') then title || ' uses latest runtime - ' || runtime || '.'\n    else title || ' uses ' || runtime || ' which is not the latest version.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_lambda_function;\n"
Connector:
    - AWS
