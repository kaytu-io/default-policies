ID: aws_ec2_instance_in_vpc
Title: EC2 instances should be in a VPC
Description: Deploy AWS Elastic Compute Cloud (AWS EC2) instances within an AWS Virtual Private Cloud (AWS VPC) to enable secure communication between an instance and other services within the amazon VPC, without requiring an internet gateway, NAT device, or VPN connection.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          arn as resource,
          case
            when vpc_id is null then 'alarm'
            else 'ok'
          end as status,
          case
            when vpc_id is null then title || ' not in VPC.'
            else title || ' in VPC.'
          end as reason
          
          
        from
          aws_ec2_instance;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
