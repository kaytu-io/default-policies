Title: "Steampipe Table: aws_ecr_repository - Query AWS ECR Repositories using SQL"
Description: "Allows users to query AWS Elastic Container Registry (ECR) Repositories and retrieve detailed information about each repository."
Connectors:
    - AWS
Query:
    Engine: odysseus-v0.0.1
    QueryToExecute: |-
        select
          repository_name,
          r -> 'selection' ->> 'tagStatus' as tag_status,
          r -> 'selection' ->> 'countType' as count_type
        from
          aws_ecr_repository,
          jsonb_array_elements(lifecycle_policy -> 'rules') as r
        where
          (
            (r -> 'selection' ->> 'tagStatus' <> 'untagged')
            and (
              r -> 'selection' ->> 'countType' <> 'sinceImagePushed'
            )
          );
