connectors:
- AWS
query: |-
  select 
    principal_arn,
    service_name,
    last_authenticated,
    age(last_authenticated::date),
    a ->> 'ActionName' as action_name,
    a ->> 'LastAccessedEntity' as action_last_accessed_entity,
    a ->> 'LastAccessedRegion' as action_last_accessed_region,
    a ->> 'LastAccessedTime' as action_last_accessed_time
  from 
    aws_iam_access_advisor,
    jsonb_array_elements(tracked_actions_last_accessed) as a
  where
    principal_arn = 'arn:aws:iam::123456789123:user/jane'
    and last_authenticated is not null
    and service_namespace = 's3'
  order by 
    age asc;
  
Title: "Steampipe Table: aws_iam_access_advisor - Query AWS IAM Access Advisor using SQL"
Description: "Allows users to query AWS IAM Access Advisor to retrieve information about the service last accessed data for IAM entities (users, groups, and roles)."
