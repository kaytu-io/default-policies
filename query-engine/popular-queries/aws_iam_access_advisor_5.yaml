Title: "Steampipe Table: aws_iam_access_advisor - Query AWS IAM Access Advisor using SQL"
Description: "Allows users to query AWS IAM Access Advisor to retrieve information about the service last accessed data for IAM entities (users, groups, and roles)."
Connectors:
    - AWS
Query:
    Engine: odysseus-v0.0.1
    QueryToExecute: "select \n  principal_arn,\n  service_name,\n  last_authenticated,\n  age(last_authenticated::date),\n  a ->> 'ActionName' as action_name,\n  a ->> 'LastAccessedEntity' as action_last_accessed_entity,\n  a ->> 'LastAccessedRegion' as action_last_accessed_region,\n  a ->> 'LastAccessedTime' as action_last_accessed_time\nfrom \n  aws_iam_access_advisor,\n  jsonb_array_elements(tracked_actions_last_accessed) as a\nwhere\n  principal_arn = 'arn:aws:iam::123456789123:user/jane'\n  and last_authenticated is not null\n  and service_namespace = 's3'\norder by \n  age asc;"
