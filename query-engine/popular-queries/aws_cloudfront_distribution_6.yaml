Title: "Steampipe Table: aws_cloudfront_distribution - Query AWS CloudFront Distributions using SQL"
Description: "Allows users to query AWS CloudFront Distributions to gain insights into their configuration, status, and associated metadata."
Connectors:
    - AWS
Query:
    Engine: odysseus-v0.0.1
    QueryToExecute: |-
        select
          id,
          arn,
          p -> 'CustomOriginConfig' -> 'OriginSslProtocols' -> 'Items' as items,
          p -> 'CustomOriginConfig' -> 'OriginSslProtocols' -> 'Quantity' as quantity
        from
          aws_cloudfront_distribution,
          jsonb_array_elements(origins) as p
        where
          p -> 'CustomOriginConfig' -> 'OriginSslProtocols' -> 'Items' ?& array['SSLv3'];
