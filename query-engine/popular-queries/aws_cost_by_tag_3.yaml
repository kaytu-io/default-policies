connectors:
- AWS
query: |-
  with ranked_costs as
  (
    select
      tag_key_1,
      tag_value_1,
      period_start,
      unblended_cost_amount::numeric::money,
      rank() over(partition by tag_key_1
    order by
      unblended_cost_amount desc)
    from
      aws_cost_by_tag
    where
      granularity = 'DAILY'
      and tag_key_1 = 'Name'
  )
  select
    *
  from
    ranked_costs
  where
    rank <= 10;
  
Title: "Steampipe Table: aws_cost_by_tag - Query AWS Cost Explorer using SQL"
Description: "Allows users to query AWS Cost Explorer to obtain cost allocation tags and associated costs."
