connectors:
- AWS
query: |-
  select
    arn,
    p as principal,
    a as action,
    s ->> 'Effect' as effect
  from
    aws_codeartifact_repository,
    jsonb_array_elements(policy_std -> 'Statement') as s,
    jsonb_array_elements_text(s -> 'Principal' -> 'AWS') as p,
    string_to_array(p, ':') as pa,
    jsonb_array_elements_text(s -> 'Action') as a
  where
    s ->> 'Effect' = 'Allow'
    and (
      pa [5] != account_id
      or p = '*'
    );
  
Title: "Steampipe Table: aws_codeartifact_repository - Query AWS CodeArtifact Repository using SQL"
Description: "Allows users to query AWS CodeArtifact Repository data, including details about the repository, its domain ownership, and associated metadata."
