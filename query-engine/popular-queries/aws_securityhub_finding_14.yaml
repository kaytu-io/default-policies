connectors:
- AWS
query: |-
  select
    distinct i.instance_id,
    i.instance_state,
    i.instance_type,
    f.title,
    f.compliance_status,
    f.severity ->> 'Original' as severity_original
  from
    aws_ec2_instance as i,
    aws_securityhub_finding as f,
    jsonb_array_elements(resources) as r
  where
    compliance_status = 'FAILED'
  and
    r ->> 'Type' = 'AwsEc2Instance'
  and
    i.arn = r ->> 'Id';
  
Title: "Steampipe Table: aws_securityhub_finding - Query AWS Security Hub Findings using SQL"
Description: "Allows users to query AWS Security Hub Findings to gather information about security issues identified within AWS resources. This includes details such as the severity, status, and description of the finding, the resources affected, and any remediation steps recommended."
