connectors:
- AWS
query: |-
  select
    title,
    p as principal,
    a as action,
    s ->> 'Effect' as effect,
    s -> 'Condition' as conditions
  from
    aws_ecrpublic_repository,
    jsonb_array_elements(policy -> 'Statement') as s,
    jsonb_array_elements_text(s -> 'Principal' -> 'AWS') as p,
    jsonb_array_elements_text(s -> 'Action') as a
  where
    s ->> 'Effect' = 'Allow'
    and a in ('*', 'ecr-public:*');
  
Title: "Steampipe Table: aws_ecrpublic_repository - Query AWS Elastic Container Registry Public Repository using SQL"
Description: "Allows users to query AWS Elastic Container Registry Public Repository to get detailed information about each ECR public repository within an AWS account."
